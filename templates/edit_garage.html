{% extends "layout.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Редактировать гараж</h2>
    <form method="POST" enctype="multipart/form-data">
        <div class="mb-3">
            <label for="title" class="form-label">Название</label>
            <input type="text" class="form-control" id="title" name="title" value="{{ garage.title }}" required>
        </div>
        <div class="mb-3">
            <label for="description" class="form-label">Описание</label>
            <textarea class="form-control" id="description" name="description" rows="3">{{ garage.description }}</textarea>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="price" class="form-label">Цена (₽/мес)</label>
                <input type="number" class="form-control" id="price" name="price" value="{{ garage.price }}" required>
            </div>
            <div class="col-md-6 mb-3">
                <label for="area" class="form-label">Площадь (м²)</label>
                <input type="number" class="form-control" id="area" name="area" value="{{ garage.area }}" required>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="height" class="form-label">Высота (м)</label>
                <input type="number" step="0.01" class="form-control" id="height" name="height" value="{{ garage.height }}">
            </div>
            <div class="col-md-6 mb-3">
                <label for="vehicle_type" class="form-label">Тип транспорта</label>
                <select class="form-select" id="vehicle_type" name="vehicle_type">
                    <option value="car" {% if garage.vehicle_type == 'car' %}selected{% endif %}>Легковой автомобиль</option>
                    <option value="truck" {% if garage.vehicle_type == 'truck' %}selected{% endif %}>Грузовой автомобиль</option>
                    <option value="motorcycle" {% if garage.vehicle_type == 'motorcycle' %}selected{% endif %}>Мотоцикл</option>
                </select>
            </div>
        </div>
        <div class="mb-3">
            <label for="address" class="form-label">Адрес</label>
            <input type="text" class="form-control" id="address" name="address" value="{{ garage.address }}" required>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="district" class="form-label">Район</label>
                <input type="text" class="form-control" id="district" name="district" value="{{ garage.district }}" required>
            </div>
            <div class="col-md-6 mb-3">
                <label for="security" class="form-label">Охрана</label>
                <select class="form-select" id="security" name="security">
                    <option value="none" {% if garage.security == 'none' %}selected{% endif %}>Нет</option>
                    <option value="guard" {% if garage.security == 'guard' %}selected{% endif %}>Охранник</option>
                    <option value="cctv" {% if garage.security == 'cctv' %}selected{% endif %}>Видеонаблюдение</option>
                </select>
            </div>
        </div>
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="has_power" name="has_power" {% if garage.has_power %}checked{% endif %}>
            <label class="form-check-label" for="has_power">Есть электричество</label>
        </div>
        <div class="mb-3">
            <label class="form-label">Текущие фотографии</label>
            <div class="row">
                {% for photo in photos %}
                <div class="col-md-3 mb-3 position-relative">
                    <img src="{{ url_for('static', filename='uploads/' + photo.image_url) }}" class="img-thumbnail" style="height: 150px; width: 100%; object-fit: cover;">
                    <form action="{{ url_for('delete_garage_photo', photo_id=photo.id) }}" method="POST" class="position-absolute top-0 end-0">
                        <button type="submit" class="btn btn-danger btn-sm">×</button>
                    </form>
                </div>
                {% endfor %}
            </div>
        </div>
        <div class="mb-3">
            <label for="photos" class="form-label">Добавить фотографии</label>
            <input type="file" class="form-control" id="photos" name="photos" multiple accept="image/*">
        </div>
        <button type="submit" class="btn btn-primary">Сохранить изменения</button>
        <a href="{{ url_for('garage_detail', garage_id=garage.id) }}" class="btn btn-secondary">Отмена</a>
    </form>
</div>
{% endblock %}